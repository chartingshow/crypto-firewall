## What is Typosquatting?

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/1.jpg" alt="Typosquatting"></p>

Typosquatting goes by many names: URL hijacking, domain mimicry and domain typo-squatting, to name a few. However, they all mean the same thing: malicious attackers register domain names similar to popular websites but with common typos and variations.

Typosquatting is the malicious practice of registering domain names that closely resemble popular brands and businesses. Attackers do this in the hope of deceiving users. A user might mistype the web address and land up on a malicious site. The site may show harmless ads. More seriously, it might look like the genuine site. The user may then perform transactions and thereby disclose sensitive information.

Typosquatting can also be done on software packages. Developers might unknowingly download and install malicious packages. This compromises the security of their applications.

Typosquatting could be combined with other cyberattacks such as phishing. Domain owners, developers and users have to take precautions to protect themselves against typosquatting.

Typosquatting leaves individuals vulnerable to identity theft, malware and virus attacks, inappropriate content and more. It also hurts businesses, who miss out on revenue when customers shop typosquatting sites and suffer reputational damage when users have a negative experience.

Organizations must watch out for fraudulent websites and take action when needed. Here is what you need to know about typosquatting and how to protect your business against it.

## How typosquatting works

Visitors typically end up visiting a fraudulent website in two ways:

* **Mistyping the name of a website directly** into their browser instead of using Google or another search engine. For example, they write `gooogle.com` instead of `google.com`
* **Being lured into a lookalike website** as the result of a phishing attack.

The websites may try to create the same look and feel as the web pages they're mimicking to bait users into disclosing personal information, such as login info or credit card details. Bad actors can then use this information, especially if users have the same usernames and passwords on multiple sites so that even unrelated accounts are at risk.

Typosquatting relies on human errors, such as:

* **Typos**. Although a simple human error, accidentally pressing the wrong letter can significantly affect users. These errors occur when users mistype the URL by pressing the wrong keys. For example, "googIe.com" with a capital I instead of "google.com" with a lower-case L.
* **Top-level domain (TLD)**. These errors occur when users type in the wrong domain ending. For example, "google.co" instead of "google.com."
* **Subdomain**. Users accidentally type the subdomain as part of the main domain, like "bloggoogle.com" instead of "blog.google.com."
* **Hyphenated domains**. Some domain names include hyphens, leading to errors if users mistakenly add one or forget to use it. For example, "amazon-prime.com" instead of "amazon.com".
* **Alternative spellings**. Some typosquatting websites rely on different spelling to lure in users. For example, "write" instead of "right." They are also common for words with variations for US or UK English. For example, "color" in American English is spelled "colour" in British English.

### Examples

Many typosquatting incidents go unnoticed, but there have been some famous cases that gained attention:

* In 2006, David Cenciotti registered the domain `Goggle.com`. He used the website to display ads and generate traffic revenue. Google took legal action against Cenciotti and the domain was transferred to Google.
* In 2013, the domain `twiter.com` was discovered, which redirected users to a survey scam that tricked visitors into providing personal information. Thousands of users fell victim to the fraud before it was finally removed.
* Also in 2013, Facebook won a settlement against over 100 domain squatters requiring them to pay almost $2.8 million.

Even the largest and most secure corporations must be diligent against typosquatting to ensure it doesn't compromise customer data or hurt their reputation.

## Types of Typosquatting

There are many different reasons that hackers use typosquatted domains. Just a few uses include:

### Install malware

The biggest reason hackers use fraudulent websites is to host malicious content or encourage users to download infected files. One study found that over 18% of registered squatting domains were malicious and used to distribute malware or conduct a phishing attack.

### Phishing

By resembling legitimate websites, hackers trick users into providing sensitive information for identity theft, fraudulent transactions and other cybercrimes.

### Advertising

Some fraudulent websites display ads or use click fraud schemes to generate revenue from unsuspecting visitors, these ads may:

* Redirect users to other malicious websites.
* Trick them into downloading malware.

### Competitor disruption

Bad actors siphon web traffic from legitimate websites by registering domain names similar to their competitors. It can be a form of corporate sabotage or a way to get an unfair advantage.

### Counterfeit sales

Some typosquatted websites sell counterfeit and knockoff products. These products can harm the reputation of the legitimate brand and trick consumers into buying low-quality items they cannot return.

### Spamming

Some of these domains are used to send spam or phishing emails that appear to come from legitimate sources. By using a domain that closely resembles the real one, attackers can increase the chances that recipients will open and interact with the malicious emails.

## How to protect against typosquatting

Typosquatting can hurt company sales and brand reputations, so organizations must diligently fend off attempts. While any business can be a potential target for typosquatting, certain companies and industries are more vulnerable:

* High-traffic websites.
* E-commerce retailers and financial institutions.
* Brands with strong name recognition.
* Businesses with complex domain names.

There are multiple steps you should take to protect your business from typosquatting:

**Register common misspellings and variations**. The first step is stopping bad actors from acquiring the domains in the first place. Proactively register domain names that are common misspellings, variations, or phonetic approximations of your primary domain.

**Acquire alternative TLDs**. Register your domain name with various TLDs, like `.net`, `.org` and `.co`, to reduce the likelihood of typosquatters exploiting these alternatives.

**Monitor domain registrations**. [ICANN](https://www.icann.org/) (Internet Corporation for Assigned Names and Numbers) has a [Trademark Clearing House](https://www.trademark-clearinghouse.com/) that allows website owners to monitor how their names are used with different domains. Regularly check in to see how names similar to your brand or domain are used.

**Implement domain name system security extensions (DNSSEC)**. DNSSEC will protect your domain from multiple cyber threats, including typosquatting.

**Report fraudulent domains**. Report typosquatted domains to relevant authorities like ICANN or the domain registrar. They may be able to suspend or remove the fraudulent site.

**Pursue legal action**. If you discover a typosquatted domain that infringes on your copyright or trademarks, legal action may be necessary to control the domain and prevent further harm. If relevant authorities cannot remove the site, consider getting a lawyer to help.

**Educate customers and employees**. Raise awareness among your customers and employees about potential typosquatting. Let them know the risks and encourage them to double-check URLs and use a search engine to find your website.

While stopping all typosquatting may be impossible, you can mitigate some risks and better protect your brand, reputation and customers.

## Protecting against fraudulent websites

Typosquatting is a common malicious practice used for various nefarious purposes, such as phishing, malware distribution, traffic diversion and more. They pose significant risks to both visitors and businesses.

To protect your business from typosquatting by proactively registering misspellings and variations on your domain name and monitoring registrations. Be prepared to take legal action when necessary and report any suspicious registrations immediately. These strategies can help you better safeguard your reputation, brand and customers from the various threats posed by typosquatted websites.

### What aspects of software can be attacked by typosquatting?

Typosquatting can occur on **domain names**. This is sometimes called _DNS Typosquatting_ or _URL hijacking_. Suppose a user wishes to visit `live.com` but mistypes this as `livve.com`, `live.cm` or `liv.ecom`. This is not exactly harmful if such domains don't exist. However, attackers can register these domains and thereby redirect requests meant for `live.com` to their own servers. This compromises the intended client-server interaction.

**Software supply chain** is about how software packages are distributed by developers and downloaded by other developers for use in their applications. A developer wishing to use a package may mistype the name and thereby install the wrong package. The wrong package has been shared by the attacker. Thus, instead of installing `atlas_client`, the developer may install `atlas-client` that contains malicious code.

Thus, broadly we have domain typosquatting or package typosquatting. In either case, typosquatting makes sense for highly popular domains or packages. Even if a small proportion of users make a typo error, the attackers stand to benefit a great deal.

### Which are some variations or techniques in typosquatting?

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/2.jpg" alt="Typosquatting"></p>

<p align="center">Above: Some typosquatting techniques.</p>

Let's assume that the correct domain name is "cisecurity.org". Here are some typosquatting variations, some of which can be easily mistyped by users:

* **Omission**: "csecurity.org" where the first "i" is omitted.
* **Addition**: "cissecurity.org" where an extra "s" is added.
* **Substitution**: "cisecurlty.org" where "l" fills in for a "i". Another example is "cisecurity.com".
* **Transposition**: "csiecurity.org" where "i" and "s" positions are swapped.
* **Hyphenation**: "ci-security.org" where there's an extra hyphen.

These variations can be described differently. Assuming that the domain is "google.com", we can have misspelling (goggle.com), extra period (goo.gle.com), confusion between numbers and letters (g00gle.com), phrasal change (googles.com), or additional words (googlesearch.com).

### Which are some advanced typosquatting techniques?

Here are some advanced typosquatting techniques:

* **Homograph Attacks**: This relies of visual similarity. For example, uppercase "i" in sans-serif font looks similar to "l". Another example is "Ñƒ", which is actually the Cyrillic U that looks like Latin "y". However, this sort of an attack is not that common.
* **Bitsquatting**: This relies on computer hardware to make errors at bit level. For example, "microsoft.com" could be typosquatted as "mic2osoft.com", with one bit in error (0x32 for "2" and 0x72 for "r").
* **Soundsquatting**: When two words sound similar but are spelled differently, users can end up picking up the incorrect one. For example, "ate" may be mistaken for "eight".
* **Typosquatting Cross-Site Scripting (TXSS)**: This relates to software developers who use the wrong domain name in their code. For example, they might mistype the URL of a JavaScript library that they wish to use in a HTML page. This is a series problem since every user visiting the page gets exposed to the typosquatting domain.

### What harm can domain typosquatting cause to systems and businesses?

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/3.jpg" alt="Typosquatting"></p>

<p align="center">Above: Typosquatting and redirection used to inject malware into systems</p>

Popular brands lose traffic as their users get redirected to typosquatting domains. In fact, traffic can get redirected to competitor sites.

Data theft can erode brand value. In 2011, variations of YouTube.com appeared and these redirected to a survey form that collected mobile numbers from unsuspecting users. The "survey" lured users to an SMS subscription that was charged to their phone bills. In another example, omitting a dot in an email addresses resulted in loss of 120,000 emails from Fortune 500 companies over six months. These emails contained trade secrets and invoices.

Typosquatters can abuse affiliate programs and collect referral fees on behalf of genuine site owners.

Users can be tricked into downloading malware. When typosquatting sites look exactly like their genuine counterparts, users may be tricked to enter login credentials and disclose sensitive information. Some typosquatting sites are less harmful. For example, a company offering vacation packages may typosquat on the domains of major airlines and show ads for vacation packages.

It's been found that financial services, retail and critical infrastructure are industries most affected by typosquatting.

### Which are some best practices to protect against domain typosquatting?

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/4.jpg" alt="Typosquatting"></p>

<p align="center">Above: Check for HTTPS and domain name before the URL</p>

If you have a domain, one defensive technique is to register common variations and typo errors of that domain.

Implement two-factor authentication (2FA) for the safety of your customers. Always use SSL certificates so that customers can verify site ownership. Educate your users so that they're aware of common attacks. Having a trademark gives you the option to file a case against typosquatters. Improve SEO on your site so that search engines rank it better than the typosquatted ones.

As a user, enable 2FA for better protection of your accounts. When sensitive information or money transfer is involved, it's better to verify by call before performing the online transaction. Pay attention to how domains are spelled, in URLs and email addresses. Check that site is served on HTTPS. It's equally important to check the domain name that browsers display before the URL.

Avoid typing out URLs. Instead, bookmark the sites you often visit and use these bookmarks instead. In addition, you can install suitable browser plugins that warn potential typosquatting domains on mistyped URLs.

### What tools or algorithms are available to counter domain typosquatting?

[DNS Twist](https://github.com/elceef/dnstwist) can "detect typosquatters, phishing attacks, fraud and brand impersonation". By running _dnstwist_ on your domain, you can find if it's being typosquatted.

First released in 2006, Microsoft provides [Strider URL Tracer](https://www.microsoft.com/en-us/download/details.aspx?id=52290) to investigate third-party domains. This also generates typosquatted variations and scans them.

Some typos are more likely than others. A probabilistic analysis helps in ranking them. Typing test tools and human-based computation games can help estimate the probabilities. For example, adjacent characters on the keyboard are more likely to be swapped.

Feature engineering is an essential task when building your own detection algorithm. Features could be based on domain average TTL value, domain-IP address association, common ASN's shared by IP addresses, hit-count of domain, n-gram distribution of characters in domain name and many more. Lot of information can be obtained from DNS records, WHOIS lookup and even crawling the site.

Algorithms could be knowledge-based where experts identify and apply features. With sophisticated attacks, machine learning-based algorithms are more effective. They're data-driven. ML for domain typosquatting is possible due to easily available data that's collected by ISPs and network administrators.

### What are some AI/ML approaches to detecting typosquatting domains?

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/5.jpg" alt="Typosquatting"></p>

<p align="center">Above: Detect typosquatting domains via feature selection and bagging ensemble model</p>

Among the ML approaches are:

* **Supervised**: Relies on labelled datasets. _DomainProfiler_ is an example that used 55 features along with random forest algorithm. The limitation is that labelled datasets are expensive to create.
* **Semi-Supervised**: Uses both labelled and unlabelled data. Graph-based inference methods such as belief propagation are used in which it's assumed that malicious hosts are most likely to communicate with malicious domains. Another approach is clustering based on co-occurrence patterns such as domain names often seen together in DNS resolver logs.
* **Unsupervised**: Clustering is done to identify at least two clusters of malicious or benign domains. This is then extended to identify sub-clusters based on the type of malicious behaviour.

In practice, hybrid approaches are adopted to achieve better results. For example, one approach used three different feature selection methods, reduced them to a subset of features and trained a bagging ensemble model. Two ensemble models were explored: decision tree and k-nearest neighbour.

For evaluation of these algorithms, accuracy, precision, recall, F1-score and Area Under the Curve (AUC) are commonly reported.

### What harm can package typosquatting cause to applications and their users?

In software package management, typosquatting can be used to steal cryptocurrency. Malicious packages can attempt to redirect cryptocurrency payments to a wallet address of their choice. This has been seen in Ruby (via RubyGems) and JavaScript (via npm).

When a typosquatting package is installed, it gets access to environment variables. Such packages then attempt to steal user credentials and other secrets that are usually part of environment. A well-known example of this (from August 2017) is `crossenv` typosquatting on `cross-env` at npm. In PyPI, two typosquatting packages attempted to steal GPG and SSH keys from developers.

The typical exploit is to run arbitrary code during installation. Worse still is when such an execution is done with administrative privileges. Some packages may even attempt to inject malicious code into the application's source code.

A less harmful attack is to replicate the original functionality and thereby divert attribution from the original package. On npm, typosquatting package `asimplemde` does this for `simplemde`.

### What can I do to mitigate package typosquatting?

Developers must be more vigilant when copying and pasting package names. Use safe options when installing dependencies. For example, use the `--ignore-scripts` option when installing using npm.

Developers should use digital signatures (using `gpg`) and checksums (using `sha256sum`) to deliver their software packages in a secure way. This prevents hackers from modifying the content to include typosquatted names.

Package repositories for their part can have checks and rules that minimize the attack surface. For example, npm requires that new packages can't match existing package names with the punctuation removed. Given `react-native`, names `react_native` and `re.a_ct-native` are not allowed.

Repositories can also maintain a list of possible names with small Levenshtein distances. Administrators can be notified if there's an attempt to install one of these. In fact, server logs would contain 404 errors for non-existing packages that users typed by mistake. These can be added to the list to proactively prevent typosquatting.

[SpellBound](https://arxiv.org/pdf/2003.03471.pdf) is a tool that can be used to detect typosquatting names. It adds a runtime overhead of less than 2.5%.

## Historical timeline of typosquattingMilestones

### 1998

R.C. Cumbow in The New York Law Journal uses the term **typosquatter**, probably the first published use of the term.

### 1999

Seeing the growing threat of domain typosquatting, the Internet Corporation for Assigned Names and Numbers Internet Corporation for Assigned Names and Numbers (ICANN) introduces the **Uniform Domain Name Dispute Resolution Policy (UDRP)**. In the U.S., there's also the Anti-cybersquatting Consumer Protection Act Anti-cybersquatting Consumer Protection Act (ACPA).

### Jan 2003

What is possibly one of the first large-scale studies, Benjamin Edelman identifies 8,800 typosquatted domains. Many of these have invalid WHOIS data, provide explicit sexual content and even prevent users from exiting the site. Many of these sites are registered to John Zuccarini, who is eventually arrested in September.

### Mar 2003

As part of [RFC 3490](https://www.rfc-editor.org/rfc/rfc3490), the Internet Engineering Task Force (IETF) defines Internationalized Domain Name Internationalized Domain Name (IDN). This allows domain names to contain alphabet-specific characters. This unfortunately opens the doors to **homograph attacks**. English domain names could be typosquatted by substituting some letters with non-Latin letters that have identical glyphs (same visual appearance).

### 2006

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/6.jpg" alt="Typosquatting"></p>

<p align="center">Above: Top six domain parking services with typosquatted domains</p>

An analysis of top 10,000 domains shows that 30% of all missing-dot typos come from just six domain parking services. These six account for 2995 typosquatted domains. In all, 5094 typosquatted domains are found to be active.

### 2008

Banerjee et al. observe that about 99% of all typosquatted domains use **one-character modification**. More formally, such a domain differs from the real domain by a Damerau-Levenshtein distance of one. They also propose ways to automate typosquatted domain name generation: 1-mod-inplace, 1-mod-deflate, 1-mod-inflate.

### 2011

At the Black Hat 2011 Technical Security Conference, Artem Dinaburg reveals **bitsquatting** as a technique towards typosquatting. Random bit errors in domain names can cause computers to fetch content from bitsquatted domains. With 30 bitsquatted domains, he finds 52,317 requests from 12,949 unique Internet Protocol (IP) addresses over a period of eight months. An example of this is `www.mic2osoft.com`. Typical use is to serve ads, abuse affiliate programs or install malware.

### 2014

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/7.jpg" alt="Typosquatting"></p>

<p align="center">Above: Framework for detecting typosquatting domains</p>

Szurdi et al. propose a framework to detect typosquatting domains. They start with passive data sources from which they generate possible typosquatting domain names. To obtain more information, they actively crawl WHOIS database, collect Domain Name System (DNS) data and obtain web page content. They cluster domains based on various features. Their approach is called: Yet Another Typosquatting Tool (YATT).

### Feb 2018

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/8.jpg" alt="Typosquatting"></p>

<p align="center">Above: Levenshtein distances among package names on npm</p>

One researcher investigates package names on npm in terms of Levenshtein distance. He finds that 46% of names are at a distance of two or less. Longer the name, less likely it has a small distance to another name. Distance of one can indicate typosquatting. However, npm's preference for short names makes this hard. There are many genuine packages that have small distances: (preact, react), (bocha, mocha) and (class-names, classnames).

### Mar 2018

A network of malicious sites ending in ".cm" is discovered. These sites were typosquatting on many popular ".com" sites and attempting to trick users with fake security alerts. Four years of access logs from this network is also discovered and analyzed by security experts. They find that within the first three months of 2018, these sites got about about 12 million visits, almost 50 million visits per year.

### Apr 2020

<p align="center"><img src="https://github.com/chartingshow/crypto-firewall/blob/master/assets/images/typosquatting/9.jpg" alt="Typosquatting"></p>

<p align="center">Above: Typosquatting names found in RubyGems repository</p>

Packages for Ruby (called gems) are distributed via RubyGems repository. An analysis by ReversingLabs finds more than 700 malicious gems due to typosquatting. They describe the example of `atlas_client` typosquatting as `atlas-client`. It contains `aaa.png` that's in fact a portable executable. It contains a Base64 encoded VBScript. It's designed to steal cryptocurrency by modifying wallet addresses.
